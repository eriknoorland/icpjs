!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(r="undefined"!=typeof globalThis?globalThis:r||self).icpjs=t()}(this,(function(){"use strict";function r(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(r){e(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function e(r,t,e){return(t=function(r){var t=function(r,t){if("object"!=typeof r||null===r)return r;var e=r[Symbol.toPrimitive];if(void 0!==e){var n=e.call(r,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}(r,"string");return"symbol"==typeof t?t:String(t)}(t))in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function n(r){return function(r){if(Array.isArray(r))return o(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,t){if(!r)return;if("string"==typeof r)return o(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o(r,t)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}var i=function(r,t){var e=r.x-t.x,n=r.y-t.y;return Math.pow(e*e+n*n,.5)},a=i,u=function(r,t){return{x:r.x-t.x,y:r.y-t.y}},y=function(r){var t=r.x,e=r.y;return t*t+e*e},f=function(r,t){var e=t.x1,n=t.y1,o=t.x2,i=t.y2,a=y(u(r,{x:o,y:i})),f=y(u({x:e,y:n},{x:o,y:i})),c=y(u(r,{x:e,y:n}));if(c+f<a)return{x:e,y:n};if(a+f<c)return{x:o,y:i};var l,p,s=n-i,x=o-e,h=e*i-o*n;if(0===x){if(0===s)return;l=-s,s=-1,h/=l}else s/=l=-x,x=-1,h/=l;return 0!==x?{x:p=0!==s?(r.x/s+r.y-h)/(s+1/s):r.x,y:s*p+h}:{x:h/-s,y:r.y}},c=i,l=i,p=function(r,t){return r.map((function(r){return{x:r.x+t.x,y:r.y+t.y}}))},s=function(r,t){var e=t.phi,n=Math.sin(e),o=Math.cos(e);return r.map((function(r){return{x:o*r.x-n*r.y,y:n*r.x+o*r.y}}))},x=function(r,t){for(var e,n=t.length,o=1/0,i=0;i<n;i+=1){var u=t[i],y=a(r,u);y<o&&(o=y,e=u)}return e},h=function(r,t){for(var e,n=t.length,o=1/0,i=0;i<n;i+=1){var a=t[i],u=f(r,a),y=c(r,u);y<o&&(o=y,e=u)}return e},b=function(){var r={POINT_TO_POINT:x,POINT_TO_PLANE:h};return{run:function(e,o){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0,phi:0},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t({method:r.POINT_TO_POINT,maxIterations:20,tolerance:.1},a),y=o.length,f={x:0,y:0,phi:0},c=n(o),x=0,h=0;h<u.maxIterations;h+=1){for(var b=0,v=0,m=0,d=0,O=0,g=0,j=0,P=0,w=0,T=0;T<y;T+=1){var I=c[T],S=u.method(I,e);if(S){b+=1;var M={x:I.x-i.x,y:I.y-i.y},A={x:S.x-i.x,y:S.y-i.y};v+=M.x,m+=A.x,d+=M.y,O+=A.y,g+=M.x*A.x,j+=M.y*A.y,P+=M.x*A.y,w+=M.y*A.x,Math.abs(M.x-A.x),Math.abs(M.y-A.y)}}var N=b,_=g-v*m/N,E=j-d*O/N,D=P-v*O/N,k=w-d*m/N,C=v/N,L=d/N,R=m/N,U=O/N,$=l({x:C,y:L},{x:R,y:U});if($<u.tolerance)break;var q={x:0,y:0,phi:0};q.phi=Math.atan2(D-k,_+E);var z=Math.cos(q.phi),B=Math.sin(q.phi);q.x=R-(C*z-L*B),q.y=U-(C*B+L*z);i.phi,c=p(c,q),c=s(c,q),f.x+=q.x,f.y+=q.y,f.phi+=q.phi,x+=1}return{transformation:f,dataPoints:c,numIterations:x}},methods:r,utils:{applyTranslation:p,applyRotation:s}}};return b()}));
